@page "/admin/direccion-talento-humano"
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Components
@using ProyectoAgiles.Application.DTOs
@using proyectoAgiles.Services
@layout proyectoAgiles.Layout.MainLayout
@inject NavigationManager Navigation
@inject proyectoAgiles.Services.UserSessionService UserSession
@inject proyectoAgiles.Services.AuthService AuthService
@inject HttpClient HttpClient
@inject IJSRuntime JSRuntime

<PageTitle>Dirección de Talento Humano - UTA</PageTitle>

<div class="direccion-talento-humano-page">
    <!-- Botón Volver Flotante -->
    <div class="back-button-container">
        <button class="btn btn-outline-secondary" @onclick="GoBack">
            <i class="fas fa-arrow-left"></i> Volver
        </button>
    </div>

    <div class="page-container">
        <!-- Título de la Página -->
        <div class="page-header">
            <div class="header-content">
                <h1 class="page-title">Dirección de Talento Humano</h1>
                <p class="page-subtitle">Gestión final de solicitudes de escalafón docente</p>
            </div>
        </div>

        <!-- Resumen de Solicitudes -->
        <div class="summary-cards">
            <div class="summary-card approved">
                <div class="summary-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="summary-content">
                    <h3>@approvedSolicitudes</h3>
                    <p>Aprobadas por Presidente de la Comisión</p>
                </div>
            </div>
            
            <div class="summary-card processed">
                <div class="summary-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="summary-content">
                    <h3>@processedSolicitudes</h3>
                    <p>Solicitudes Firmadas</p>
                </div>
            </div>
            
            <div class="summary-card rejected">
                <div class="summary-icon">
                    <i class="fas fa-times-circle"></i>
                </div>
                <div class="summary-content">
                    <h3>@rejectedByTalentoHumano</h3>
                    <p>Rechazadas por T.H.</p>
                </div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="filters-section">
            <div class="filters-container">
                <select class="form-select" @bind="selectedFilter">
                    <option value="aprobado">Aprobadas por Presidente de la Comisión</option>
                    <option value="procesado">Firmadas</option>
                    <option value="rechazado-th">Rechazadas por T.H.</option>
                    <option value="all">Todas</option>
                </select>
                
                <input type="text" class="form-control" placeholder="Buscar por nombre o cédula..." @bind="searchTerm" @oninput="FilterSolicitudes" />
                
                <button class="btn btn-primary" @onclick="RefreshSolicitudes">
                    <i class="fas fa-refresh"></i> Actualizar
                </button>
            </div>
        </div>

        <!-- Lista de Solicitudes -->
        <div class="solicitudes-section">
            @if (filteredSolicitudes?.Any() == true)
            {
                @foreach (var solicitud in filteredSolicitudes)
                {
                    <div class="solicitud-card @GetStatusClass(solicitud.Status)">
                        <div class="solicitud-header">
                            <div class="solicitud-info">
                                <h4>@solicitud.DocenteNombre</h4>
                                <p class="solicitud-cedula">
                                    <i class="fas fa-id-card"></i> @solicitud.DocenteCedula
                                </p>
                                <p class="solicitud-fecha">
                                    <i class="fas fa-calendar"></i> Aprobada: @(solicitud.FechaAprobacion?.ToString("dd/MM/yyyy HH:mm") ?? "No disponible")
                                </p>
                            </div>
                            <div class="solicitud-status">
                                <span class="status-badge @GetStatusClass(solicitud.Status)">
                                    @GetStatusText(solicitud.Status)
                                </span>
                            </div>
                        </div>

                        <div class="solicitud-details">
                            <div class="detail-row">
                                <span class="detail-label">Nivel Actual:</span>
                                <span class="detail-value">@solicitud.NivelActual</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Nivel Solicitado:</span>
                                <span class="detail-value">@solicitud.NivelSolicitado</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Años de Experiencia:</span>
                                <span class="detail-value">@solicitud.AnosExperiencia años</span>
                            </div>
                        </div>

                        <div class="solicitud-actions">
                            <button class="btn btn-info" @onclick="() => VerDetalles(solicitud.Id)">
                                <i class="fas fa-eye"></i> Ver Detalles
                            </button>
                            
                            @if (solicitud.Status == "Aprobado")
                            {
                                <button class="btn btn-success" @onclick="() => ProcesarSolicitud(solicitud.Id)">
                                    <i class="fas fa-pen-fancy"></i> Firmar
                                </button>
                                <button class="btn btn-danger" @onclick="() => RechazarSolicitudTH(solicitud.Id)">
                                    <i class="fas fa-times"></i> Rechazar
                                </button>
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="no-solicitudes">
                    <div class="no-solicitudes-icon">
                        <i class="fas fa-inbox"></i>
                    </div>
                    <h3>No hay solicitudes</h3>
                    <p>No se encontraron solicitudes que coincidan con los filtros seleccionados.</p>
                </div>
            }
        </div>
    </div>
</div>

<!-- Modal de Detalles -->
@if (showDetailsModal)
{
    <div class="modal fade show" style="display: block;" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de la Solicitud de Escalafón</h5>
                    <button type="button" class="btn-close" @onclick="CloseDetailsModal"></button>
                </div>
                <div class="modal-body">
                    @if (selectedSolicitud != null)
                    {
                        <!-- Resumen de Cumplimiento de Requisitos -->
                        <div class="details-section">
                            <h6><i class="fas fa-clipboard-check"></i> Resumen de Cumplimiento de Requisitos</h6>
                            @if (estadisticasDocente?.Secciones != null)
                            {
                                <div class="requirements-summary">
                                    <div class="requirement-summary-item">
                                        <span class="requirement-name">Años de Experiencia</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Experiencia.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Experiencia.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <div class="requirement-summary-item">
                                        <span class="requirement-name">Publicaciones</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Obras.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Obras.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <div class="requirement-summary-item">
                                        <span class="requirement-name">Capacitaciones</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Capacitaciones.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Capacitaciones.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <div class="requirement-summary-item">
                                        <span class="requirement-name">Evaluación Desempeño</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Evaluaciones.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Evaluaciones.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <div class="overall-compliance">
                                        <span class="overall-label">Estado General:</span>
                                        <span class="overall-status @(estadisticasDocente.Resumen.PuedeSubirNivel ? "cumple-todos" : "no-cumple-todos")">
                                            @if (estadisticasDocente.Resumen.PuedeSubirNivel)
                                            {
                                                <i class="fas fa-check-circle"></i>
                                                <span>Cumple todos los requisitos (@estadisticasDocente.Resumen.RequisitosCumplidos/@estadisticasDocente.Resumen.TotalRequisitos)</span>
                                            }
                                            else
                                            {
                                                <i class="fas fa-exclamation-triangle"></i>
                                                <span>No cumple todos los requisitos (@estadisticasDocente.Resumen.RequisitosCumplidos/@estadisticasDocente.Resumen.TotalRequisitos)</span>
                                            }
                                        </span>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Cargando estadísticas de requisitos...
                                </div>
                            }
                        </div>

                        <!-- Información Personal -->
                        <div class="details-section">
                            <h6><i class="fas fa-user"></i> Información Personal</h6>
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <tbody>
                                        <tr>
                                            <td><strong>Nombre Completo:</strong></td>
                                            <td>@selectedSolicitud.DocenteNombre</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Cédula:</strong></td>
                                            <td>@selectedSolicitud.DocenteCedula</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Email:</strong></td>
                                            <td>@selectedSolicitud.DocenteEmail</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Información Académica -->
                        <div class="details-section">
                            <h6><i class="fas fa-graduation-cap"></i> Información Académica</h6>
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <tbody>
                                        <tr>
                                            <td><strong>Nivel Actual:</strong></td>
                                            <td>@selectedSolicitud.NivelActual</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Nivel Solicitado:</strong></td>
                                            <td>@selectedSolicitud.NivelSolicitado</td>
                                        </tr>                        <tr>
                            <td><strong>Años de Experiencia:</strong></td>
                            <td>
                                @if (estadisticasDocente?.Secciones?.Experiencia?.Datos != null)
                                {
                                    <div class="requirement-item">
                                        <span>@estadisticasDocente.Secciones.Experiencia.Datos.AñosObtenidos años</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Experiencia.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Experiencia.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <small class="text-muted">Requerido: @estadisticasDocente.Secciones.Experiencia.Datos.AñosRequeridos años - @estadisticasDocente.Secciones.Experiencia.Datos.Detalles</small>
                                }
                                else
                                {
                                    <span>@selectedSolicitud.AnosExperiencia años</span>
                                    <small class="text-muted">Cargando información...</small>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Publicaciones:</strong></td>
                            <td>
                                @if (estadisticasDocente?.Secciones?.Obras?.Datos != null)
                                {
                                    <div class="requirement-item">
                                        <span>Total: @estadisticasDocente.Secciones.Obras.Datos.TotalObras obra(s). Con filiación UTA: @estadisticasDocente.Secciones.Obras.Datos.ObrasConUTA obra(s)</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Obras.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Obras.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <small class="text-muted">@estadisticasDocente.Secciones.Obras.Datos.Detalles</small>
                                }
                                else
                                {
                                    <span>@(string.IsNullOrEmpty(selectedSolicitud.Publicaciones) ? "No especificadas" : selectedSolicitud.Publicaciones)</span>
                                    <small class="text-muted">Cargando información...</small>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Capacitaciones:</strong></td>
                            <td>
                                @if (estadisticasDocente?.Secciones?.Capacitaciones?.Datos != null)
                                {
                                    <div class="requirement-item">
                                        <span>Total: @estadisticasDocente.Secciones.Capacitaciones.Datos.HorasObtenidas horas. Pedagógicas: @estadisticasDocente.Secciones.Capacitaciones.Datos.HorasPedagogicasObtenidas horas</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Capacitaciones.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Capacitaciones.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <small class="text-muted">Requerido: @estadisticasDocente.Secciones.Capacitaciones.Datos.HorasRequeridas horas totales (@estadisticasDocente.Secciones.Capacitaciones.Datos.HorasPedagogicasRequeridas pedagógicas)</small>
                                }
                                else
                                {
                                    <span>@(string.IsNullOrEmpty(selectedSolicitud.Capacitaciones) ? "No especificadas" : selectedSolicitud.Capacitaciones)</span>
                                    <small class="text-muted">Cargando información...</small>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Evaluación de Desempeño:</strong></td>
                            <td>
                                @if (estadisticasDocente?.Secciones?.Evaluaciones?.Datos != null)
                                {
                                    <div class="requirement-item">
                                        <span>Promedio: @estadisticasDocente.Secciones.Evaluaciones.Datos.PromedioObtenido% (@estadisticasDocente.Secciones.Evaluaciones.Datos.EvaluacionesAnalizadas evaluaciones)</span>
                                        <span class="requirement-status @(estadisticasDocente.Secciones.Evaluaciones.Datos.Cumple ? "cumple" : "no-cumple")">
                                            @if (estadisticasDocente.Secciones.Evaluaciones.Datos.Cumple)
                                            {
                                                <i class="fas fa-check"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-times"></i>
                                            }
                                        </span>
                                    </div>
                                    <small class="text-muted">Requerido: @estadisticasDocente.Secciones.Evaluaciones.Datos.Requiere75% - @estadisticasDocente.Secciones.Evaluaciones.Datos.Detalles</small>
                                }
                                else
                                {
                                    <span>Cargando información...</span>
                                    <small class="text-muted">Evaluando desempeño...</small>
                                }
                            </td>
                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Tabla de Investigación -->
                        <div class="details-section">
                            <h6><i class="fas fa-search"></i> Investigación</h6>
                            <div class="table-responsive">
                                <table class="table professional-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-book me-2"></i>Título</th>
                                            <th><i class="fas fa-flask me-2"></i>Área</th>
                                            <th><i class="fas fa-tag me-2"></i>Tipo</th>
                                            <th><i class="fas fa-chart-line me-2"></i>Estado</th>
                                            <th><i class="fas fa-calendar me-2"></i>Fecha Pub.</th>
                                            <th><i class="fas fa-university me-2"></i>Filiación</th>
                                            <th><i class="fas fa-cogs me-2"></i>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (GetInvestigacionesDocente(selectedSolicitud).Any())
                                        {
                                            @foreach (var investigacion in GetInvestigacionesDocente(selectedSolicitud))
                                            {
                                                <tr>
                                                    <td class="col-title">
                                                        <div class="fw-medium">@investigacion.Titulo</div>
                                                        @if (!string.IsNullOrEmpty(investigacion.RevistaOEditorial))
                                                        {
                                                            <small class="text-muted d-block mt-1">
                                                                <i class="fas fa-newspaper me-1"></i>@investigacion.RevistaOEditorial
                                                            </small>
                                                        }
                                                    </td>
                                                    <td>
                                                        <span class="table-badge info">
                                                            <i class="fas fa-atom"></i>
                                                            @investigacion.CampoConocimiento
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span class="table-badge secondary">
                                                            @investigacion.Tipo
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span class="table-badge success">
                                                            <i class="fas fa-check-circle"></i>
                                                            Publicado
                                                        </span>
                                                    </td>
                                                    <td class="col-date">
                                                        <i class="fas fa-calendar-alt me-1"></i>
                                                        @investigacion.FechaPublicacion.ToString("dd/MM/yyyy")
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrEmpty(investigacion.Filiacion))
                                                        {
                                                            <span class="table-badge @(investigacion.Filiacion.Contains("UTA", StringComparison.OrdinalIgnoreCase) || investigacion.Filiacion.Contains("Universidad Técnica de Ambato", StringComparison.OrdinalIgnoreCase) ? "success" : "secondary")">
                                                                @if (investigacion.Filiacion.Contains("UTA", StringComparison.OrdinalIgnoreCase) || investigacion.Filiacion.Contains("Universidad Técnica de Ambato", StringComparison.OrdinalIgnoreCase))
                                                                {
                                                                    <i class="fas fa-check-circle"></i>
                                                                }
                                                                @investigacion.Filiacion
                                                            </span>
                                                        }
                                                        else
                                                        {
                                                            <span class="text-muted">
                                                                <i class="fas fa-minus-circle me-1"></i>Sin filiación
                                                            </span>
                                                        }
                                                    </td>
                                                    <td class="col-actions">
                                                        <div class="action-btn-group">
                                                            @if (investigacion.TienePdf)
                                                            {
                                                                <button class="action-btn view" @onclick="() => VerPdf(investigacion.Id)" title="Ver PDF">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </button>
                                                            }
                                                            else
                                                            {
                                                                <span class="text-muted">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </span>
                                                            }
                                                        </div>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr>
                                                <td colspan="7" class="empty-state">
                                                    <i class="fas fa-search"></i>
                                                    <h6>No hay investigaciones registradas</h6>
                                                    <p>No se encontraron investigaciones para este docente</p>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Tabla de Evaluación -->
                        <div class="details-section">
                            <h6><i class="fas fa-chart-line"></i> Evaluación de Desempeño</h6>
                            <div class="table-responsive">
                                <table class="table professional-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-calendar-alt me-2"></i>Período</th>
                                            <th><i class="fas fa-calendar me-2"></i>Año</th>
                                            <th><i class="fas fa-list-ol me-2"></i>Sem.</th>
                                            <th><i class="fas fa-chart-bar me-2"></i>Puntaje</th>
                                            <th><i class="fas fa-percentage me-2"></i>Porcentaje</th>
                                            <th><i class="fas fa-check-circle me-2"></i>Estado</th>
                                            <th><i class="fas fa-clock me-2"></i>Fecha Eval.</th>
                                            <th><i class="fas fa-user-tie me-2"></i>Evaluador</th>
                                            <th><i class="fas fa-cogs me-2"></i>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (GetEvaluacionesDocente(selectedSolicitud).Any())
                                        {
                                            @foreach (var evaluacion in GetEvaluacionesDocente(selectedSolicitud))
                                            {
                                                <tr>
                                                    <td class="fw-medium">
                                                        <i class="fas fa-graduation-cap me-2 text-primary"></i>
                                                        @evaluacion.PeriodoAcademico
                                                    </td>
                                                    <td class="col-date">
                                                        <span class="table-badge info">@evaluacion.Anio</span>
                                                    </td>
                                                    <td class="text-center">
                                                        <span class="table-badge secondary">@evaluacion.Semestre</span>
                                                    </td>
                                                    <td class="col-score">
                                                        <div class="fw-bold">@evaluacion.PuntajeObtenido</div>
                                                        <small class="text-muted">/ @evaluacion.PuntajeMaximo</small>
                                                    </td>
                                                    <td class="col-score">
                                                        <span class="table-badge @(evaluacion.PorcentajeObtenido >= 90 ? "success" : evaluacion.PorcentajeObtenido >= 75 ? "warning" : "danger")">
                                                            <i class="fas @(evaluacion.PorcentajeObtenido >= 90 ? "fa-trophy" : evaluacion.PorcentajeObtenido >= 75 ? "fa-star" : "fa-exclamation-triangle")"></i>
                                                            @evaluacion.PorcentajeObtenido.ToString("F1")%
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span class="table-badge @(evaluacion.CumpleMinimo ? "success" : "danger")">
                                                            <i class="fas @(evaluacion.CumpleMinimo ? "fa-check" : "fa-times")"></i>
                                                            @evaluacion.Estado
                                                        </span>
                                                    </td>
                                                    <td class="col-date">
                                                        <i class="fas fa-calendar-check me-1"></i>
                                                        @evaluacion.FechaEvaluacion.ToString("dd/MM/yyyy")
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrEmpty(evaluacion.Evaluador))
                                                        {
                                                            <div class="fw-medium">@evaluacion.Evaluador</div>
                                                            <small class="text-muted">@evaluacion.TipoEvaluacion</small>
                                                        }
                                                        else
                                                        {
                                                            <span class="text-muted">
                                                                <i class="fas fa-user-slash me-1"></i>Sin asignar
                                                            </span>
                                                        }
                                                    </td>
                                                    <td class="col-actions">
                                                        <div class="action-btn-group">
                                                            @if (!string.IsNullOrEmpty(evaluacion.NombreArchivoRespaldo))
                                                            {
                                                                <button class="action-btn view" @onclick="() => VerPdfEvaluacion(evaluacion.Id)" title="Ver PDF">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </button>
                                                            }
                                                            else
                                                            {
                                                                <span class="text-muted">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </span>
                                                            }
                                                        </div>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr>
                                                <td colspan="9" class="empty-state">
                                                    <i class="fas fa-star"></i>
                                                    <h6>No hay evaluaciones de desempeño registradas</h6>
                                                    <p>No se encontraron evaluaciones para este docente</p>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Tabla de Capacitación -->
                        <div class="details-section">
                            <h6><i class="fas fa-graduation-cap"></i> Capacitación y Formación</h6>
                            <div class="table-responsive">
                                <table class="table professional-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-graduation-cap me-2"></i>Nombre</th>
                                            <th><i class="fas fa-university me-2"></i>Institución</th>
                                            <th><i class="fas fa-tag me-2"></i>Tipo</th>
                                            <th><i class="fas fa-laptop me-2"></i>Modalidad</th>
                                            <th><i class="fas fa-clock me-2"></i>Horas</th>
                                            <th><i class="fas fa-calendar-plus me-2"></i>Fecha Inicio</th>
                                            <th><i class="fas fa-calendar-check me-2"></i>Fecha Fin</th>
                                            <th><i class="fas fa-chart-line me-2"></i>Estado</th>
                                            <th><i class="fas fa-cogs me-2"></i>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (GetCapacitacionesDocente(selectedSolicitud).Any())
                                        {
                                            @foreach (var capacitacion in GetCapacitacionesDocente(selectedSolicitud))
                                            {
                                                <tr>
                                                    <td class="col-title">
                                                        <div class="fw-medium">@capacitacion.NombreCapacitacion</div>
                                                        @if (!string.IsNullOrEmpty(capacitacion.Descripcion))
                                                        {
                                                            <small class="text-muted d-block mt-1" title="@capacitacion.Descripcion">
                                                                <i class="fas fa-info-circle me-1"></i>@capacitacion.Descripcion.Substring(0, Math.Min(50, capacitacion.Descripcion.Length))...
                                                            </small>
                                                        }
                                                    </td>
                                                    <td>
                                                        <div class="fw-medium">@capacitacion.Institucion</div>
                                                        @if (!string.IsNullOrEmpty(capacitacion.Instructor))
                                                        {
                                                            <small class="text-muted d-block mt-1">
                                                                <i class="fas fa-user-tie me-1"></i>@capacitacion.Instructor
                                                            </small>
                                                        }
                                                    </td>
                                                    <td>
                                                        <span class="table-badge @(capacitacion.EsPedagogica ? "success" : "info")">
                                                            <i class="fas @(capacitacion.EsPedagogica ? "fa-chalkboard-teacher" : "fa-cogs")"></i>
                                                            @capacitacion.TipoCapacitacion
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span class="table-badge secondary">
                                                            <i class="fas @(capacitacion.Modalidad.Contains("Virtual", StringComparison.OrdinalIgnoreCase) ? "fa-laptop" : capacitacion.Modalidad.Contains("Presencial", StringComparison.OrdinalIgnoreCase) ? "fa-users" : "fa-sync-alt")"></i>
                                                            @capacitacion.Modalidad
                                                        </span>
                                                    </td>
                                                    <td class="col-score">
                                                        <div class="fw-bold text-primary">@capacitacion.HorasAcademicas</div>
                                                        <small class="text-muted">horas</small>
                                                    </td>
                                                    <td class="col-date">
                                                        <i class="fas fa-calendar-alt me-1"></i>
                                                        @capacitacion.FechaInicio.ToString("dd/MM/yyyy")
                                                    </td>
                                                    <td class="col-date">
                                                        <i class="fas fa-calendar-check me-1"></i>
                                                        @capacitacion.FechaFin.ToString("dd/MM/yyyy")
                                                    </td>
                                                    <td>
                                                        <span class="table-badge @(capacitacion.Estado?.ToLower() switch { "aprobada" or "completada" => "success", "en progreso" => "warning", "reprobada" => "danger", _ => "secondary" })">
                                                            <i class="fas @(capacitacion.Estado?.ToLower() switch { "aprobada" or "completada" => "fa-check-circle", "en progreso" => "fa-clock", "reprobada" => "fa-times-circle", _ => "fa-question-circle" })"></i>
                                                            @capacitacion.Estado
                                                        </span>
                                                        @if (capacitacion.Calificacion.HasValue)
                                                        {
                                                            <div class="mt-1">
                                                                <small class="text-muted">
                                                                    <i class="fas fa-star me-1"></i>@capacitacion.Calificacion.Value.ToString("F1")
                                                                </small>
                                                            </div>
                                                        }
                                                    </td>
                                                    <td class="col-actions">
                                                        <div class="action-btn-group">
                                                            @if (!string.IsNullOrEmpty(capacitacion.NombreArchivoCertificado))
                                                            {
                                                                <button class="action-btn view" @onclick="() => VerPdfCapacitacion(capacitacion.Id)" title="Ver Certificado">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </button>
                                                            }
                                                            else
                                                            {
                                                                <span class="text-muted">
                                                                    <i class="fas fa-file-pdf"></i>
                                                                </span>
                                                            }
                                                        </div>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr>
                                                <td colspan="9" class="empty-state">
                                                    <i class="fas fa-search"></i>
                                                    <h6>No hay capacitaciones registradas</h6>
                                                    <p>No se encontraron capacitaciones para este docente</p>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Información de la Solicitud -->
                        <div class="details-section">
                            <h6><i class="fas fa-file-alt"></i> Información de la Solicitud</h6>
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <tbody>
                                        <tr>
                                            <td><strong>Fecha de Solicitud:</strong></td>
                                            <td>@selectedSolicitud.FechaSolicitud.ToString("dd/MM/yyyy HH:mm")</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Fecha de Aprobación:</strong></td>
                                            <td>@(selectedSolicitud.FechaAprobacion?.ToString("dd/MM/yyyy HH:mm") ?? "No disponible")</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Estado:</strong></td>
                                            <td>
                                                <span class="status-badge @GetStatusClass(selectedSolicitud.Status)">
                                                    @GetStatusText(selectedSolicitud.Status)
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Observaciones:</strong></td>
                                            <td>@(string.IsNullOrEmpty(selectedSolicitud.Observaciones) ? "Sin observaciones" : selectedSolicitud.Observaciones)</td>
                                        </tr>
                                        @if (!string.IsNullOrEmpty(selectedSolicitud.MotivoRechazo))
                                        {
                                            <tr>
                                                <td><strong>Motivo de Rechazo:</strong></td>
                                                <td>@selectedSolicitud.MotivoRechazo</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    }
                </div>
                <div class="modal-footer">
                    @if (selectedSolicitud?.Status == "Aprobado")
                    {
                        <button type="button" class="btn btn-success" @onclick="() => ProcesarSolicitud(selectedSolicitud.Id)">
                            <i class="fas fa-pen-fancy"></i> Firmar
                        </button>
                        <button type="button" class="btn btn-danger" @onclick="() => RechazarSolicitudTH(selectedSolicitud.Id)">
                            <i class="fas fa-times"></i> Rechazar
                        </button>
                    }
                    <button type="button" class="btn btn-secondary" @onclick="CloseDetailsModal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show"></div>
}

<!-- Modal de Rechazo -->
@if (showRejectModal)
{
    <div class="modal fade show" style="display: block;" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Rechazar Solicitud</h5>
                    <button type="button" class="btn-close" @onclick="CloseRejectModal"></button>
                </div>
                <div class="modal-body">
                    <p>¿Está seguro que desea rechazar esta solicitud de escalafón desde Talento Humano?</p>
                    <div class="mb-3">
                        <label class="form-label">Motivo del rechazo:</label>
                        <textarea class="form-control" rows="3" @bind="motivoRechazo" placeholder="Ingrese el motivo del rechazo desde Talento Humano..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" @onclick="ConfirmRejectTH">
                        <i class="fas fa-times"></i> Rechazar
                    </button>
                    <button type="button" class="btn btn-secondary" @onclick="CloseRejectModal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show"></div>
}

@code {
    // Variables para el manejo de solicitudes
    private List<SolicitudEscalafon> solicitudes = new List<SolicitudEscalafon>();
    private List<SolicitudEscalafon> filteredSolicitudes = new List<SolicitudEscalafon>();
    private SolicitudEscalafon? selectedSolicitud;
    
    // Variables para contadores
    private int approvedSolicitudes = 0;
    private int processedSolicitudes = 0;
    private int rejectedByTalentoHumano = 0;
    
    // Variables para filtros
    private string selectedFilter = "all";
    private string searchTerm = "";
    
    // Variables para modales
    private bool showDetailsModal = false;
    private bool showRejectModal = false;
    private string motivoRechazo = "";
    private int solicitudToReject = 0;
    
    // Variables para datos detallados
    private List<proyectoAgiles.Services.InvestigacionDto> investigaciones = new List<proyectoAgiles.Services.InvestigacionDto>();
    private List<proyectoAgiles.Services.EvaluacionDesempenoDto> evaluaciones = new List<proyectoAgiles.Services.EvaluacionDesempenoDto>();
    private List<ProyectoAgiles.Application.DTOs.DiticDto> capacitaciones = new List<ProyectoAgiles.Application.DTOs.DiticDto>();
    private proyectoAgiles.Services.EstadisticasDocenteResponse? estadisticasDocente;

    protected override async Task OnInitializedAsync()
    {
        await UserSession.InitializeAsync();
        
        if (UserSession.CurrentUser == null || UserSession.CurrentUser.UserType != 1)
        {
            Navigation.NavigateTo("/login");
            return;
        }
        
        await LoadSolicitudes();
        FilterSolicitudes();
        UpdateCounters();
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/admin/talento-humano");
    }

    private async Task LoadSolicitudes()
    {
        try
        {
            // Cargar solicitudes desde la API
            var response = await HttpClient.GetAsync("/api/solicitudes-escalafon");
            
            if (response.IsSuccessStatusCode)
            {
                var solicitudesDto = await response.Content.ReadFromJsonAsync<List<ProyectoAgiles.Application.DTOs.SolicitudEscalafonDto>>();
                
                if (solicitudesDto != null)
                {
                    // Convertir DTOs a modelo local
                    solicitudes = solicitudesDto.Select(dto => new SolicitudEscalafon
                    {
                        Id = dto.Id,
                        DocenteNombre = dto.DocenteNombre,
                        DocenteCedula = dto.DocenteCedula,
                        DocenteEmail = dto.DocenteEmail,
                        DocenteTelefono = dto.DocenteTelefono ?? "",
                        Facultad = dto.Facultad ?? "",
                        Carrera = dto.Carrera ?? "",
                        NivelActual = dto.NivelActual,
                        NivelSolicitado = dto.NivelSolicitado,
                        AnosExperiencia = dto.AnosExperiencia,
                        Titulos = dto.Titulos ?? "",
                        Publicaciones = dto.Publicaciones ?? "",
                        Capacitaciones = dto.Capacitaciones ?? "",
                        FechaSolicitud = dto.FechaSolicitud,
                        FechaAprobacion = dto.FechaAprobacion,
                        FechaRechazo = dto.FechaRechazo,
                        Status = dto.Status,
                        Observaciones = dto.Observaciones ?? "",
                        MotivoRechazo = dto.MotivoRechazo ?? ""
                    }).ToList();
                }
                else
                {
                    solicitudes = new List<SolicitudEscalafon>();
                }
            }
            else
            {
                // En caso de error de API, inicializar lista vacía
                solicitudes = new List<SolicitudEscalafon>();
                await JSRuntime.InvokeVoidAsync("console.error", $"Error loading solicitudes: {response.StatusCode}");
            }
        }
        catch (Exception ex)
        {
            // En caso de error, inicializar lista vacía
            solicitudes = new List<SolicitudEscalafon>();
            await JSRuntime.InvokeVoidAsync("console.error", $"Exception loading solicitudes: {ex.Message}");
        }
    }

    private void FilterSolicitudes()
    {
        var filtered = solicitudes.AsEnumerable();

        // EXCLUIR siempre las solicitudes pendientes - estas solo las ve el Presidente
        // EXCLUIR también las apelaciones - estas solo las ve la Comisión Académica de Escalafón
        // EXCLUIR también las rechazadas por el Presidente
        // EXCLUIR también las rechazadas por la Comisión Académica de Escalafón (después de procesar apelaciones)
        // EXCLUIR también las verificadas - estas ya fueron procesadas por el Presidente
        // EXCLUIR también las AprobadoPresidente - estas están en proceso de generar informe por el Presidente
        filtered = filtered.Where(s => s.Status != "Pendiente" && s.Status != "Apelacion" && s.Status != "RechazadoPresidente" && s.Status != "RechazadoComision" && s.Status != "Verificado" && s.Status != "AprobadoPresidente");

        // Filtrar por estado
        filtered = selectedFilter switch
        {
            "aprobado" => filtered.Where(s => s.Status == "Aprobado"),
            "procesado" => filtered.Where(s => s.Status == "Procesado"),
            "rechazado-th" => filtered.Where(s => s.Status == "RechazadoTH"),
            _ => filtered
        };

        // Filtrar por término de búsqueda
        if (!string.IsNullOrWhiteSpace(searchTerm))
        {
            filtered = filtered.Where(s => 
                s.DocenteNombre.Contains(searchTerm, StringComparison.OrdinalIgnoreCase) ||
                s.DocenteCedula.Contains(searchTerm, StringComparison.OrdinalIgnoreCase));
        }

        filteredSolicitudes = filtered.ToList();
    }

    private void UpdateCounters()
    {
        // Solo contar solicitudes que debe ver Talento Humano (excluir Verificado, AprobadoPresidente entre otros estados)
        var solicitudesVisibles = solicitudes.Where(s => s.Status != "Pendiente" && s.Status != "Apelacion" && s.Status != "RechazadoPresidente" && s.Status != "RechazadoComision" && s.Status != "Verificado" && s.Status != "AprobadoPresidente");
        
        // Solo contar solicitudes con estado "Aprobado" (no incluir AprobadoPresidente)
        approvedSolicitudes = solicitudesVisibles.Count(s => s.Status == "Aprobado");
        processedSolicitudes = solicitudesVisibles.Count(s => s.Status == "Procesado");
        rejectedByTalentoHumano = solicitudesVisibles.Count(s => s.Status == "RechazadoTH");
    }

    private async Task RefreshSolicitudes()
    {
        await LoadSolicitudes();
        FilterSolicitudes();
        UpdateCounters();
        StateHasChanged();
    }

    private async Task VerDetalles(int solicitudId)
    {
        try
        {
            selectedSolicitud = solicitudes.FirstOrDefault(s => s.Id == solicitudId);
            if (selectedSolicitud != null)
            {
                await CargarDatosDocente(selectedSolicitud.DocenteCedula);
                showDetailsModal = true;
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("console.error", $"Error al ver detalles: {ex.Message}");
        }
    }

    private void CloseDetailsModal()
    {
        showDetailsModal = false;
        selectedSolicitud = null;
    }

    private async Task ProcesarSolicitud(int solicitudId)
    {
        try
        {
            var updateDto = new { Id = solicitudId, Status = "Procesado" };
            var response = await HttpClient.PutAsJsonAsync($"/api/solicitudes-escalafon/{solicitudId}/status", updateDto);
            
            if (response.IsSuccessStatusCode)
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.success", 
                    "Solicitud Firmada", 
                    "La solicitud ha sido firmada exitosamente.");
                await RefreshSolicitudes();
                CloseDetailsModal();
            }
            else
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "Error", 
                    "No se pudo firmar la solicitud.");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                "Error", 
                $"Error al firmar la solicitud: {ex.Message}");
        }
    }

    private void RechazarSolicitudTH(int solicitudId)
    {
        solicitudToReject = solicitudId;
        motivoRechazo = "";
        showRejectModal = true;
    }

    private async Task ConfirmRejectTH()
    {
        try
        {
            if (string.IsNullOrWhiteSpace(motivoRechazo))
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "Error", 
                    "Debe ingresar un motivo para el rechazo.");
                return;
            }

            // Usar el nuevo endpoint de rechazo con motivo
            var rechazarDto = new { 
                MotivoRechazo = motivoRechazo,
                RechazadoPor = "Dirección de Talento Humano",
                NivelRechazo = "DireccionTalentoHumano"
            };
            var response = await HttpClient.PostAsJsonAsync($"/api/solicitudes-escalafon/{solicitudToReject}/rechazar", rechazarDto);
            
            if (response.IsSuccessStatusCode)
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.success", 
                    "Solicitud Rechazada", 
                    "La solicitud ha sido rechazada por Talento Humano. Se ha enviado un email al docente con el motivo del rechazo.");
                await RefreshSolicitudes();
                CloseDetailsModal();
                CloseRejectModal();
            }
            else
            {
                var errorMessage = await response.Content.ReadAsStringAsync();
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "Error", 
                    $"No se pudo rechazar la solicitud: {errorMessage}");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                "Error", 
                $"Error al rechazar la solicitud: {ex.Message}");
        }
    }

    private void CloseRejectModal()
    {
        showRejectModal = false;
        solicitudToReject = 0;
        motivoRechazo = "";
    }

    private string GetStatusClass(string status)
    {
        return status switch
        {
            "Aprobado" => "approved",
            "Procesado" => "processed",
            "RechazadoTH" => "rejected",
            _ => "default"
        };
    }

    private string GetStatusText(string status)
    {
        return status switch
        {
            "Aprobado" => "Aprobado por Presidente de la Comisión",
            "Procesado" => "Firmado",
            "RechazadoTH" => "Rechazado por T.H.",
            _ => status
        };
    }

    // Métodos para obtener datos de las tablas
    private List<proyectoAgiles.Services.InvestigacionDto> GetInvestigacionesDocente(SolicitudEscalafon solicitud)
    {
        return investigaciones;
    }

    private List<proyectoAgiles.Services.EvaluacionDesempenoDto> GetEvaluacionesDocente(SolicitudEscalafon solicitud)
    {
        return evaluaciones;
    }

    private List<ProyectoAgiles.Application.DTOs.DiticDto> GetCapacitacionesDocente(SolicitudEscalafon solicitud)
    {
        return capacitaciones;
    }
    
    // Métodos para ver PDFs
    private async Task VerPdf(int investigacionId)
    {
        try
        {
            var pdfBytes = await AuthService.ObtenerPdfInvestigacion(investigacionId);
            
            if (pdfBytes is not null && pdfBytes.Length > 0)
            {
                var base64 = Convert.ToBase64String(pdfBytes);
                var pdfDataUrl = $"data:application/pdf;base64,{base64}";
                var fileName = $"investigacion_{investigacionId}.pdf";
                
                // Usar la función JavaScript personalizada
                var success = await JSRuntime.InvokeAsync<bool>("showPdf", pdfDataUrl, fileName);
                
                if (!success)
                {
                    await JSRuntime.InvokeVoidAsync("toastNotifications.success", 
                        "PDF descargado", 
                        "El PDF se ha descargado a tu carpeta de descargas.");
                }
            }
            else
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "PDF no disponible", 
                    "No se encontró el archivo PDF para esta investigación.");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                "Error", 
                $"Error al obtener el PDF: {ex.Message}");
        }
    }

    private async Task VerPdfEvaluacion(int evaluacionId)
    {
        try
        {
            var pdfBytes = await AuthService.ObtenerPdfEvaluacion(evaluacionId);
            
            if (pdfBytes is not null && pdfBytes.Length > 0)
            {
                var base64 = Convert.ToBase64String(pdfBytes);
                var pdfDataUrl = $"data:application/pdf;base64,{base64}";
                var fileName = $"evaluacion_{evaluacionId}.pdf";
                
                var success = await JSRuntime.InvokeAsync<bool>("showPdf", pdfDataUrl, fileName);
                
                if (!success)
                {
                    await JSRuntime.InvokeVoidAsync("toastNotifications.success", 
                        "PDF descargado", 
                        "El PDF se ha descargado a tu carpeta de descargas.");
                }
            }
            else
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "PDF no disponible", 
                    "No se encontró el archivo PDF para esta evaluación.");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                "Error", 
                $"Error al obtener el PDF: {ex.Message}");
        }
    }

    private async Task VerPdfCapacitacion(int capacitacionId)
    {
        try
        {
            var pdfBytes = await AuthService.ObtenerPdfCapacitacion(capacitacionId);
            
            if (pdfBytes is not null && pdfBytes.Length > 0)
            {
                var base64 = Convert.ToBase64String(pdfBytes);
                var pdfDataUrl = $"data:application/pdf;base64,{base64}";
                var fileName = $"capacitacion_{capacitacionId}.pdf";
                
                var success = await JSRuntime.InvokeAsync<bool>("showPdf", pdfDataUrl, fileName);
                
                if (!success)
                {
                    await JSRuntime.InvokeVoidAsync("toastNotifications.success", 
                        "PDF descargado", 
                        "El PDF se ha descargado a tu carpeta de descargas.");
                }
            }
            else
            {
                await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                    "PDF no disponible", 
                    "No se encontró el archivo PDF para esta capacitación.");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("toastNotifications.error", 
                "Error", 
                $"Error al obtener el PDF: {ex.Message}");
        }
    }



    // Método para cargar datos del docente desde la API
    private async Task CargarDatosDocente(string cedula)
    {
        try
        {
            // Limpiar datos anteriores
            investigaciones.Clear();
            evaluaciones.Clear();
            capacitaciones.Clear();
            estadisticasDocente = null;

            // Cargar investigaciones
            await CargarInvestigaciones(cedula);
            
            // Cargar evaluaciones
            await CargarEvaluaciones(cedula);
            
            // Cargar capacitaciones
            await CargarCapacitaciones(cedula);
            
            // Obtener estadísticas actualizadas del docente (incluye requisitos)
            estadisticasDocente = await AuthService.ObtenerEstadisticasDocente(cedula);
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("console.error", $"Error cargando datos del docente: {ex.Message}");
        }
    }


    private async Task CargarInvestigaciones(string cedula)
    {
        try
        {
            var response = await AuthService.GetInvestigacionesPorCedula(cedula);
            if (response != null)
            {
                investigaciones = response.ToList();
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("console.error", $"Error cargando investigaciones: {ex.Message}");
        }
    }

    private async Task CargarEvaluaciones(string cedula)
    {
        try
        {
            var response = await AuthService.GetEvaluacionesPorCedula(cedula);
            if (response != null)
            {
                evaluaciones = response.ToList();
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("console.error", $"Error cargando evaluaciones: {ex.Message}");
        }
    }

    private async Task CargarCapacitaciones(string cedula)
    {
        try
        {
            var response = await AuthService.GetCapacitacionesPorCedula(cedula);
            if (response != null)
            {
                capacitaciones = response.ToList();
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("console.error", $"Error cargando capacitaciones: {ex.Message}");
        }
    }

    // Clase para los datos de solicitud
    public class SolicitudEscalafon
    {
        public int Id { get; set; }
        public string DocenteNombre { get; set; } = "";
        public string DocenteCedula { get; set; } = "";
        public string DocenteEmail { get; set; } = "";
        public string DocenteTelefono { get; set; } = "";
        public string Facultad { get; set; } = "";
        public string Carrera { get; set; } = "";
        public string NivelActual { get; set; } = "";
        public string NivelSolicitado { get; set; } = "";
        public int AnosExperiencia { get; set; }
        public string Titulos { get; set; } = "";
        public string Publicaciones { get; set; } = "";
        public string Capacitaciones { get; set; } = "";
        public DateTime FechaSolicitud { get; set; }
        public DateTime? FechaAprobacion { get; set; }
        public DateTime? FechaRechazo { get; set; }
        public string Status { get; set; } = "";
        public string Observaciones { get; set; } = "";
        public string MotivoRechazo { get; set; } = "";
    }
}
